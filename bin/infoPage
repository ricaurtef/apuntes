#!/bin/bash

# Programa para mostrar una pagina de informacion del sistema

# Definicion de variables/constantes
TITLE="System Information Report For: $HOSTNAME"
CURRENT_TIME=$(date +"%x %r %Z")
TIME_STAMP="Generated $CURRENT_TIME, by $USER"

# Definicion de funciones
reportUpTime (){
cat <<- _EOF_
      <h2>System Uptime</h2>
      <pre>
	 Since: $(uptime -s | sed -E \
         's/^([0-9]{4})-([0-9]{2})-([0-9]{2})/\2-\3-\1/')
         Total: $(uptime -p)
      </pre>
_EOF_
   
return
}

reportDiskSpace (){
cat <<- _EOF_
      <h2>Disk Space Utilization</h2>
      <pre>
	 $(df -h)
      </pre>
_EOF_

return
}

reportHomeSpace (){
echo "<h2>Top 5 Home Space Utilization</h2>"
if [[ $(id -u) == 0 ]]; then
cat <<- _EOF_
      <pre>
	 $(du -sh /home/* | sort -rh | head -n 5)
      </pre>
_EOF_
else
cat <<- _EOF_
      <pre>
	 $(du -h $HOME | sort -rh | head -n 5)
      </pre>
_EOF_
fi
return
}

cat <<- _EOF_
<html>
   <head>
      <title>$TITLE</title>
   </head>
   <body>
      <h1>$TITLE</h1>
      <p>$TIME_STAMP</p>
      <p>
	 $(reportUpTime)
	 $(reportDiskSpace)
	 $(reportHomeSpace)
      </p>
   </body>
</html>
_EOF_
